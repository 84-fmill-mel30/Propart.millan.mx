<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>PROPART V55 - RASTREADOR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #000; color: #ff00ff; font-family: monospace; padding: 20px; }
        button { width: 100%; padding: 20px; font-size: 20px; background: #ff00ff; color: #000; border: none; font-weight: bold; margin-bottom: 20px; }
        #log { border: 1px solid #555; height: 400px; overflow-y: scroll; padding: 10px; background: #111; color: #fff; font-size: 12px; }
    </style>
</head>
<body>

    <h1>üïµÔ∏è RASTREADOR DE UUIDs</h1>
    <button id="btn">üîç ANALIZAR ESC√ÅNER</button>
    <div id="log">Dale click al bot√≥n para escanear...</div>

    <script>
        const logBox = document.getElementById('log');
        function log(msg) { logBox.innerHTML += "> " + msg + "<br>"; }

        document.getElementById('btn').addEventListener('click', async () => {
            try {
                log("Buscando dispositivo...");
                const device = await navigator.bluetooth.requestDevice({
                    acceptAllDevices: true,
                    optionalServices: [
                        '0000fff0-0000-1000-8000-00805f9b34fb', // V-Link com√∫n
                        '000018f0-0000-1000-8000-00805f9b34fb', // Otro chino
                        '0000ffe0-0000-1000-8000-00805f9b34fb'  // HM-10
                    ] 
                });

                log("Conectando a: " + device.name);
                const server = await device.gatt.connect();
                log("‚úÖ CONECTADO. BUSCANDO SERVICIOS...");

                const services = await server.getPrimaryServices();
                
                log("--------------------------------");
                log("üîç SERVICIOS ENCONTRADOS (" + services.length + "):");
                
                for (const service of services) {
                    log("üëâ UUID: " + service.uuid);
                    try {
                        const chars = await service.getCharacteristics();
                        for (const c of chars) {
                            log("   ‚Ü≥ Char: " + c.uuid);
                            if (c.properties.notify) log("     (Tiene NOTIFY ‚úÖ)");
                            if (c.properties.write) log("     (Tiene WRITE ‚úÖ)");
                        }
                    } catch (err) {
                        log("   (No pude leer dentro de este)");
                    }
                    log("--------------------------------");
                }
                
                log("üèÅ AN√ÅLISIS TERMINADO. T√ìMALE FOTO.");

            } catch (error) {
                log("‚ùå ERROR: " + error);
            }
        });
    </script>
</body>
</html>
